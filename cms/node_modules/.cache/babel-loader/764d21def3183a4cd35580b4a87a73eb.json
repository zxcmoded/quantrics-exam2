{"ast":null,"code":"import assetApi from '../../api/assetApi';\nimport loading from 'vue-loading-overlay';\nexport default {\n  props: {\n    asset: {}\n  },\n  components: {\n    loading\n  },\n  name: 'edit-asset-dialog',\n  watch: {\n    asset(value) {\n      this.form.Id = value.id;\n      this.form.Name = value.name;\n      this.form.Price = value.price;\n      this.form.ValidFrom = value.validFrom ? new Date(value.validFrom).toISOString().split('T')[0] : null;\n      this.form.ValidTo = value.validTo ? new Date(value.validTo).toISOString().split('T')[0] : null;\n    }\n\n  },\n\n  data() {\n    return {\n      form: {\n        Id: null,\n        Name: '',\n        Price: 0,\n        ValidFrom: null,\n        ValidTo: null\n      },\n      isLoading: false\n    };\n  },\n\n  methods: {\n    async handleOk(bvModalEvent) {\n      try {\n        bvModalEvent.preventDefault();\n\n        if (await this.isValidInputs()) {\n          this.isLoading = true;\n          const {\n            data\n          } = await assetApi.updateAsset(this.form);\n\n          if (data.success) {\n            this.$toastr.success(data.message, 'Information');\n            this.$emit('loadList', data);\n            this.$bvModal.hide('modal-edit-asset');\n          } else {\n            this.$toastr.warning(data.message, 'Warning');\n          }\n        }\n      } catch (error) {\n        this.$toastr.error('Error updating asset', 'Error');\n      }\n\n      this.isLoading = false;\n    },\n\n    async isValidInputs() {\n      let isValid = await this.$validator.validateAll();\n\n      if (!isValid) {\n        this.$toastr.warning('Please address the field/s with invalid input.');\n        return false;\n      } else {\n        if (this.form.ValidFrom && this.form.ValidTo) {\n          if (new Date(this.form.ValidFrom) > new Date(this.form.ValidTo)) {\n            this.$toastr.warning('Valid To must be higher than Valid From');\n            return false;\n          }\n        }\n      }\n\n      return true;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAmDA;AACA;AAEA;EACAA;IACAC;EADA,CADA;EAIAC;IACAC;EADA,CAJA;EAOAC,yBAPA;EAQAC;IACAJ;MACA;MACA;MACA;MACA;MACA;IACA;;EAPA,CARA;;EAiBAK;IACA;MACAC;QACAC,QADA;QAEAC,QAFA;QAGAC,QAHA;QAIAC,eAJA;QAKAC;MALA,CADA;MAQAC;IARA;EAUA,CA5BA;;EA6BAC;IACA;MACA;QACAC;;QAEA;UACA;UAEA;YAAAT;UAAA;;UACA;YACA;YACA;YACA;UACA,CAJA,MAIA;YACA;UACA;QACA;MACA,CAfA,CAeA;QACA;MACA;;MACA;IACA,CArBA;;IAsBA;MACA;;MAEA;QACA;QACA;MACA,CAHA,MAGA;QACA;UACA;YACA;YACA;UACA;QACA;MACA;;MAEA;IACA;;EAtCA;AA7BA","names":["props","asset","components","loading","name","watch","data","form","Id","Name","Price","ValidFrom","ValidTo","isLoading","methods","bvModalEvent"],"sourceRoot":"src/views/asset","sources":["EditAssetDialog.vue"],"sourcesContent":["<template>\n    <div>\n        <loading :active.sync=\"isLoading\" :can-cancel=\"true\" :is-full-page=\"true\"></loading>\n\n        <b-modal id=\"modal-edit-asset\" ref=\"modal\" title=\"Update Asset\" ok-title=\"Update\" @ok=\"handleOk\">\n            <form>\n                <b-row>\n                    <b-col col-auto md=\"3\" class=\"my-auto\">\n                        <label>Name</label>\n                    </b-col>\n                    <b-col>\n                        <input type=\"text\" v-validate=\"'required'\" class=\"form-control\" v-model=\"form.Name\"\n                            name=\"name\" />\n                        <span v-show=\"errors.has('name')\" class=\"text-danger\">\n                            {{ errors.first('name') }}\n                        </span>\n                    </b-col>\n                </b-row>\n                <b-row class=\"mt-2\">\n                    <b-col col-auto md=\"3\" class=\"my-auto\">\n                        <label>Price</label>\n                    </b-col>\n                    <b-col>\n                        <input type=\"number\" v-model=\"form.Price\" v-validate=\"'required|min_value:0'\"\n                            class=\"form-control\" name=\"price\" />\n                        <span v-show=\"errors.has('price')\" class=\"text-danger\">\n                            {{ errors.first('price') }}\n                        </span>\n                    </b-col>\n                </b-row>\n                <b-row class=\"mt-2\">\n                    <b-col col-auto md=\"3\" class=\"my-auto\">\n                        <label>Valid From</label>\n                    </b-col>\n                    <b-col>\n                        <input type=\"date\" v-model=\"form.ValidFrom\" class=\"form-control\" name=\"ValidFrom\" />\n                    </b-col>\n                </b-row>\n                <b-row class=\"mt-2\">\n                    <b-col col-auto md=\"3\" class=\"my-auto\">\n                        <label>Valid To</label>\n                    </b-col>\n                    <b-col>\n                        <input type=\"date\" v-model=\"form.ValidTo\" class=\"form-control\" name=\"ValidTo\" />\n                    </b-col>\n                </b-row>\n            </form>\n        </b-modal>\n    </div>\n</template>\n<script>\nimport assetApi from '../../api/assetApi';\nimport loading from 'vue-loading-overlay';\n\nexport default {\n    props: {\n        asset: {}\n    },\n    components: {\n        loading\n    },\n    name: 'edit-asset-dialog',\n    watch: {\n        asset(value) {\n            this.form.Id = value.id;\n            this.form.Name = value.name;\n            this.form.Price = value.price;\n            this.form.ValidFrom = value.validFrom ? new Date(value.validFrom).toISOString().split('T')[0] : null;\n            this.form.ValidTo = value.validTo ? new Date(value.validTo).toISOString().split('T')[0] : null;\n        }\n    },\n    data() {\n        return {\n            form: {\n                Id: null,\n                Name: '',\n                Price: 0,\n                ValidFrom: null,\n                ValidTo: null\n            },\n            isLoading: false\n        }\n    },\n    methods: {\n        async handleOk(bvModalEvent) {\n            try {\n                bvModalEvent.preventDefault();\n\n                if (await this.isValidInputs()) {\n                    this.isLoading = true;\n\n                    const { data } = await assetApi.updateAsset(this.form);\n                    if (data.success) {\n                        this.$toastr.success(data.message, 'Information');\n                        this.$emit('loadList', data);\n                        this.$bvModal.hide('modal-edit-asset');\n                    } else {\n                        this.$toastr.warning(data.message, 'Warning');\n                    }\n                }\n            } catch (error) {\n                this.$toastr.error('Error updating asset', 'Error');\n            }\n            this.isLoading = false;\n        },\n        async isValidInputs() {\n            let isValid = await this.$validator.validateAll();\n\n            if (!isValid) {\n                this.$toastr.warning('Please address the field/s with invalid input.');\n                return false;\n            } else {\n                if (this.form.ValidFrom && this.form.ValidTo) {\n                    if (new Date(this.form.ValidFrom) > new Date(this.form.ValidTo)) {\n                        this.$toastr.warning('Valid To must be higher than Valid From');\n                        return false;\n                    }\n                }\n            }\n\n            return true;\n        }\n    }\n}\n</script>"]},"metadata":{},"sourceType":"module"}